syntax = "proto3";

package note;

option go_package = "github.com/taeho-io/idl/gen/go/note";

import "google/protobuf/timestamp.proto";
import "github.com/lyft/protoc-gen-validate/validate/validate.proto";

service Note {
    rpc Create (CreateRequest) returns (CreateResponse) {}
    rpc Get (GetRequest) returns (GetResponse) {}
    rpc List (ListRequest) returns (ListResponse) {}
    rpc Update (UpdateRequest) returns (UpdateResponse) {}
    rpc Delete (DeleteRequest) returns (DeleteResponse) {}
}

enum BodyType {
    TEXT = 0;
    HTML = 1;
    MARKDOWN = 2;
}

message CreateRequest {
    int64 created_by = 1 [(validate.rules).int64.gt = 999];
    BodyType body_type = 2 [(validate.rules).enum.defined_only = true];
    string title = 3;
    string body = 4;
    google.protobuf.Timestamp created_at = 5;
    google.protobuf.Timestamp updated_at = 6;
}

message CreateResponse {
    int64 note_id = 1;
}

message GetRequest {
    int64 note_id = 1 [(validate.rules).int64.gt = 999];
}

message GetResponse {
    int64 note_id = 1;
    BodyType body_type = 2;
    int64 created_by = 3;
    string title = 4;
    string body = 5;
    google.protobuf.Timestamp created_at = 6;
    google.protobuf.Timestamp updated_at = 7;
}

message NoteMessage {
    int64 note_id = 1;
    BodyType body_type = 2;
    int64 created_by = 3;
    string title = 4;
    string body = 5;
    google.protobuf.Timestamp created_at = 6;
    google.protobuf.Timestamp updated_at = 7;
}

message ListRequest {
    int64 offset = 1;
    int64 limit = 2 [(validate.rules).int64 = {gte: 0, lte: 50}];
}

message ListResponse {
    repeated NoteMessage notes = 1;
}

message UpdateRequest {
    int64 note_id = 1;
    BodyType body_type = 2;
    string title = 3;
    string body = 4;
    google.protobuf.Timestamp updated_at = 5;
}

message UpdateResponse {
}

message DeleteRequest {
    int64 note_id = 1;
}

message DeleteResponse {
}
